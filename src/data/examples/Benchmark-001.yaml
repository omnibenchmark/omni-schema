---
id: Benchmark-001
name: starts_to_be_explicit
description: simple benchmark, somewhat explicit, simple params
platform: https://gitlab.renkulab.io/
orchestrator:
  name: orchestrator
  url: https://gitlab.renkulab.io/omnibenchmark/test/orchestrator
steps:
  - id: Step1
    name: data
    initial: true
    members:
      - name: D1
        repo: omnibenchmark/test/D1
      - name: D2
        repo: omnibenchmark/test/D2
    outputs:
      - name: counts
        path: "{stage}/{module}/{params}/{name}.txt.gz"
      - name: meta
        path: "{stage}/{module}/{params}/{name}.meta.json"
      - name: data_specific_params
        path: "{stage}/{module}/{params}/{name}_params.txt"

  - name: process
    after:
      - data
    members:
      - name: P1
        repo: omnibenchmark/test/P1
        parameters:
          - -a 0, -b 0.1
          - -a 1 -b 0.1
      - name: P2
        repo: omnibenchmark/test/P2
        parameters:
          - -a 0 -c 0
          - -a 1 -c 0.1
    inputs:
      - counts
        meta
    outputs:
      - name: filtered
        path: "{input_dirname}/{stage}/{module}/{params}/{name}.txt.gz"

  - name: methods
    after:
      - process
    members:
      - name: M1
        repo: benchmark/test/M1
        exclude:
          - D2
      - name: M2
        repo: omnibenchmark/test/M2
        parameters:
          - -d1 -e1
          - -d1 -e 2
        exclude:
          - D1
          - D2
    inputs:
      - counts
        meta
        data_specific_params
      - filtered
        meta
        data_specific_params
    outputs:
      - name: mapping
        path: "{input_dirname}/{stage}/{module}/{params}/{name}.model.out.gz"

  - name: metrics
    after:
      - methods
    terminal: true
    members:
      - name: m1
        repo: omnibenchmark/test/m1
      - name: m2
        repo: omnibenchmark/test/m2
      - name: m3
        repo: omnibenchmark/test/m3
    inputs:
      - mapping
        meta
        data_specific_params